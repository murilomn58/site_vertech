<!DOCTYPE html>
<html lang="<%= t.lang %>">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= t.meta.contactTitle %></title>

    <!-- Hreflang tags for SEO -->
    <link rel="canonical" href="https://www.vertechlabs.tech<%= currentPath %>">
    <link rel="alternate" hreflang="pt-BR" href="https://www.vertechlabs.tech/contato">
    <link rel="alternate" hreflang="fr" href="https://www.vertechlabs.tech/fr/contact">
    <link rel="alternate" hreflang="en" href="https://www.vertechlabs.tech/en/contact">
    <link rel="alternate" hreflang="x-default" href="https://www.vertechlabs.tech/contato">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #1e40af;
            --text: #1e293b;
            --text-light: #64748b;
            --bg: #ffffff;
            --bg-light: #f8fafc;
            --cyan: #22D3EE;
            --cyan-dark: #0891B2;
            --navy: #0F172A;
            --border: #E2E8F0;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Space Grotesk', sans-serif; background: var(--bg-light); color: var(--text); line-height: 1.6; }

        /* Language Selector */
        .language-selector { position: fixed; top: 20px; right: 20px; display: flex; gap: 8px; z-index: 9999; background: rgba(255,255,255,0.95); padding: 8px 12px; border-radius: 30px; box-shadow: 0 4px 15px rgba(15,23,42,0.1); border: 1px solid var(--border); }
        .lang-flag { display: flex; align-items: center; padding: 4px; border-radius: 4px; opacity: 0.6; transition: all 0.2s ease; border: 2px solid transparent; text-decoration: none; }
        .lang-flag:hover { opacity: 1; }
        .lang-flag.active { opacity: 1; border-color: var(--primary); }
        .lang-flag img { display: block; border-radius: 2px; }

        /* Header */
        header { background: var(--bg); padding: 20px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 100; }
        nav { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 1.5rem; color: var(--text); text-decoration: none; }
        .logo img { height: 40px; }
        nav ul { list-style: none; display: flex; gap: 30px; }
        nav ul a { text-decoration: none; color: var(--text-light); font-weight: 500; transition: color 0.3s; }
        nav ul a:hover, nav ul a.active { color: var(--primary); }
        .cta-button { background: var(--primary); color: white; padding: 10px 20px; border-radius: 8px; font-weight: 600; }
        .cta-button:hover { background: var(--primary-dark); }

        /* Hero */
        .hero { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; padding: 80px 20px; text-align: center; }
        .hero h1 { font-size: 2.5rem; margin-bottom: 15px; }
        .hero h1 span { color: #93c5fd; }
        .hero .subtitle { opacity: 0.9; font-size: 1.1rem; }

        /* Contact Container */
        .contact-container { max-width: 800px; margin: -40px auto 60px; background: white; padding: 60px; border-radius: 20px; box-shadow: 0 10px 50px rgba(0,0,0,0.08); position: relative; z-index: 10; }
        .contact-info { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; margin-bottom: 24px; }
        .contact-item { display: flex; align-items: center; gap: 15px; padding: 20px; background: var(--bg-light); border-radius: 10px; }
        .contact-icon { width: 48px; height: 48px; object-fit: cover; border-radius: 12px; flex-shrink: 0; display: block; }
        .contact-photo { width: 64px; height: 64px; border-radius: 50%; object-fit: cover; border: 3px solid var(--primary); }
        .contact-item strong { display: block; color: var(--primary-dark); margin-bottom: 5px; }
        .contact-item a { color: var(--primary); text-decoration: none; }
        .contact-item a:hover { text-decoration: underline; }
        .contact-note { color: var(--text-light); font-weight: 700; margin-bottom: 20px; }

        /* Form */
        form { display: grid; gap: 20px; }
        input, textarea, select { width: 100%; padding: 15px; border: 2px solid #e2e8f0; border-radius: 8px; font-family: inherit; font-size: 16px; transition: border-color 0.3s; }
        input:focus, textarea:focus, select:focus { outline: none; border-color: var(--primary); }
        textarea { min-height: 150px; resize: vertical; }
        button[type="submit"] { background: var(--primary); color: white; padding: 18px; border: none; border-radius: 8px; font-weight: 700; font-size: 18px; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 15px rgba(59,130,246,0.3); }
        button[type="submit"]:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: 0 6px 20px rgba(59,130,246,0.4); }
        button[type="submit"]:disabled { opacity: 0.7; cursor: not-allowed; }

        /* Feedback Modal */
        .feedback-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15,23,42,0.55); display: flex; align-items: center; justify-content: center; padding: 20px; z-index: 1000; transition: opacity 0.3s, visibility 0.3s; }
        .feedback-modal.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
        .feedback-modal .modal-content { background: white; border-radius: 16px; padding: 36px 32px; max-width: 420px; width: 100%; box-shadow: 0 20px 70px rgba(15,23,42,0.25); text-align: center; border: 3px solid transparent; transform: translateY(0); transition: transform 0.3s; }
        .feedback-modal .modal-title { font-size: 22px; font-weight: 700; margin-bottom: 12px; }
        .feedback-modal .modal-message { color: var(--text-light); line-height: 1.6; margin-bottom: 24px; font-size: 17px; }
        .feedback-modal button[data-modal-close] { background: var(--primary); color: white; border: none; border-radius: 999px; padding: 12px 24px; font-weight: 700; cursor: pointer; transition: background 0.3s; }
        .feedback-modal button[data-modal-close]:hover { background: var(--primary-dark); }
        .feedback-modal.success .modal-content { border-color: #22c55e; }
        .feedback-modal.error .modal-content { border-color: #ef4444; }

        /* Footer */
        footer { background: var(--navy); color: #94A3B8; padding: 60px 20px 30px; text-align: center; }
        .footer-logo { font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 15px; }
        .footer-contact { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin: 20px 0; }
        .footer-contact a, .footer-contact span { color: #94A3B8; text-decoration: none; }
        .footer-contact a:hover { color: var(--cyan); }
        .footer-links { display: flex; justify-content: center; gap: 30px; margin: 20px 0; }
        .footer-links a { color: #94A3B8; text-decoration: none; font-weight: 500; }
        .footer-links a:hover { color: var(--cyan); }
        .copyright { margin-top: 30px; padding-top: 20px; border-top: 1px solid #1E293B; font-size: 0.9rem; }

        /* WhatsApp FAB */
        .whatsapp-fab { position: fixed; bottom: 30px; right: 30px; background: #25D366; color: white; padding: 15px 25px; border-radius: 50px; display: flex; align-items: center; gap: 10px; text-decoration: none; font-weight: 700; box-shadow: 0 4px 15px rgba(37,211,102,0.4); z-index: 1000; transition: all 0.3s; }
        .whatsapp-fab:hover { transform: translateY(-3px); box-shadow: 0 6px 25px rgba(37,211,102,0.5); }
        .whatsapp-fab .icon svg { width: 18px; height: 18px; }

        @media (max-width: 768px) {
            .contact-container { padding: 30px 20px; margin: -20px 15px 40px; }
            .hero h1 { font-size: 2rem; }
            nav ul { gap: 15px; }
        }
    </style>
</head>
<body>

    <!-- Language Selector -->
    <div class="language-selector">
        <a href="/contato" class="lang-flag <%= locale === 'pt' ? 'active' : '' %>" title="Português">
            <img src="/flags/br.svg" alt="PT" width="24" height="18">
        </a>
        <a href="/fr/contact" class="lang-flag <%= locale === 'fr' ? 'active' : '' %>" title="Français">
            <img src="/flags/fr.svg" alt="FR" width="24" height="18">
        </a>
        <a href="/en/contact" class="lang-flag <%= locale === 'en' ? 'active' : '' %>" title="English">
            <img src="/flags/gb.svg" alt="EN" width="24" height="18">
        </a>
    </div>

    <header>
        <nav>
            <a href="<%= locale === 'pt' ? '/' : '/' + locale %>" class="logo">
                <img src="/images/logo.svg" alt="VERTECH">VERTECH
            </a>
            <ul>
                <li><a href="<%= locale === 'pt' ? '/' : '/' + locale %>"><%= t.nav.home %></a></li>
                <li><a href="<%= currentPath %>" class="active cta-button"><%= t.nav.contact %></a></li>
            </ul>
        </nav>
    </header>

    <section class="hero">
        <div style="max-width:900px;margin:0 auto">
            <h1><%= t.contact.heroTitle %> <span><%= t.contact.heroTitleHighlight %></span></h1>
            <p class="subtitle"><%= t.contact.heroSubtitle %></p>
        </div>
    </section>

    <div class="feedback-modal hidden" id="feedbackModal">
        <div class="modal-content" tabindex="-1">
            <h4 class="modal-title" id="modalTitle"></h4>
            <p class="modal-message" id="modalMessage"></p>
            <button type="button" data-modal-close><%= t.contact.modal.close %></button>
        </div>
    </div>

    <section>
        <div class="contact-container">
            <div class="contact-note"><%= t.contact.note %></div>

            <div class="contact-info">
                <div class="contact-item">
                    <img src="/images/emailicon.jfif" alt="Email" class="contact-icon">
                    <div>
                        <strong><%= t.contact.emailLabel %></strong>
                        <a href="mailto:murilomn58@gmail.com">murilomn58@gmail.com</a>
                    </div>
                </div>
                <div class="contact-item">
                    <img src="/images/zapicon.jfif" alt="WhatsApp" class="contact-icon">
                    <div>
                        <strong><%= t.contact.whatsappLabel %></strong>
                        <span>+55 (49) 99955-1051</span>
                    </div>
                </div>
            </div>

            <div class="contact-info">
                <div class="contact-item">
                    <img src="/images/fotolinkedinmurilo.jfif" alt="Murilo Miguel Narciso" class="contact-photo">
                    <div>
                        <strong><%= t.contact.muriloTitle %></strong>
                        <a href="https://www.linkedin.com/in/murilonarciso/" target="_blank" rel="noopener">LinkedIn</a>
                    </div>
                </div>
                <div class="contact-item">
                    <img src="/images/fotolinkedinjean.jfif" alt="Jean Kairo Crispim" class="contact-photo">
                    <div>
                        <strong><%= t.contact.jeanTitle %></strong>
                        <a href="https://www.linkedin.com/in/jean-kairo-crispim-a11312284/" target="_blank" rel="noopener">LinkedIn</a>
                    </div>
                </div>
            </div>

            <h3 id="formulario" style="text-align:center;margin:32px 0 16px;color:var(--primary-dark)"><%= t.contact.formTitle %></h3>

            <form onsubmit="handleSubmit(event)">
                <input type="text" name="nome" placeholder="<%= t.contact.form.name %>" required>
                <input type="email" name="email" placeholder="<%= t.contact.form.email %>" required>
                <input type="tel" name="telefone" placeholder="<%= t.contact.form.phone %>" required>
                <input type="text" name="empresa" placeholder="<%= t.contact.form.company %>" required>
                <select name="faturamento" required>
                    <% t.contact.form.revenueOptions.forEach(function(option) { %>
                    <option value="<%= option.value %>"><%= option.label %></option>
                    <% }); %>
                </select>
                <textarea name="mensagem" placeholder="<%= t.contact.form.message %>" required></textarea>
                <button type="submit"><%= t.contact.form.submit %></button>
            </form>
        </div>
    </section>

    <footer>
        <div style="max-width:1200px;margin:0 auto">
            <div class="footer-logo">Vertech</div>
            <p style="opacity:0.9;margin-bottom:30px"><%= t.contact.footerTagline %></p>
            <div class="footer-contact">
                <a href="mailto:murilomn58@gmail.com"><%= t.contact.emailLabel %>: murilomn58@gmail.com</a>
                <a href="tel:+5549999551051">Tel: +55 (49) 99955-1051</a>
                <span><%= t.contact.whatsappLabel %>: +55 (49) 99955-1051</span>
            </div>
            <div class="footer-links">
                <a href="<%= locale === 'pt' ? '/' : '/' + locale %>"><%= t.nav.home %></a>
                <a href="<%= currentPath %>"><%= t.nav.contact %></a>
            </div>
            <div class="copyright">&copy; <%= t.footer.copyright %></div>
        </div>
    </footer>

    <a class="whatsapp-fab" href="https://wa.me/5549999551051?text=<%= encodeURIComponent(t.whatsapp.contactMessage) %>" target="_blank" rel="noopener">
        <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20.5 3.5a10.55 10.55 0 0 0-15 0 10.55 10.55 0 0 0-1.9 12.4L2 22l6.2-1.6a10.55 10.55 0 0 0 12.3-1.9 10.55 10.55 0 0 0 0-15Z"/>
                <path d="M8.5 9c0 .7.2 1.4.6 2 .3.5 1.5 2.1 3.5 3.1.3.1 1.1.5 1.6.6.4.1.8 0 1.1-.3l.7-.7c.2-.2.2-.5 0-.7l-.9-1c-.2-.2-.5-.2-.7 0l-.5.5c-.1.1-.3.1-.5.1-.2-.1-.9-.3-1.5-.8-.5-.4-.9-1-.9-1.1 0-.1 0-.2.1-.2l.5-.6c.2-.2.2-.5 0-.7l-.9-1c-.2-.2-.5-.2-.7 0L9 7.7c-.3.3-.5.8-.5 1.3Z"/>
            </svg>
        </span>
        <%= t.whatsapp.fabText %>
    </a>

    <script>
        const feedbackModal = document.getElementById('feedbackModal');
        const modalContent = feedbackModal.querySelector('.modal-content');
        const modalTitleEl = document.getElementById('modalTitle');
        const modalMessageEl = document.getElementById('modalMessage');

        const texts = {
            successTitle: "<%= t.contact.modal.successTitle %>",
            successMessage: "<%= t.contact.modal.successMessage %>",
            errorTitle: "<%= t.contact.modal.errorTitle %>",
            sending: "<%= t.contact.form.sending %>",
            submit: "<%= t.contact.form.submit %>"
        };

        const revenueLabels = {
            <% t.contact.form.revenueOptions.forEach(function(option, index) { %>
            "<%= option.value %>": "<%= option.label %>"<%= index < t.contact.form.revenueOptions.length - 1 ? ',' : '' %>
            <% }); %>
        };

        function closeModal() {
            feedbackModal.classList.add('hidden');
            feedbackModal.classList.remove('success', 'error');
        }

        function openModal(type, title, message) {
            feedbackModal.classList.remove('hidden', 'success', 'error');
            feedbackModal.classList.add(type === 'success' ? 'success' : 'error');
            modalTitleEl.textContent = title;
            modalMessageEl.textContent = message;
            modalContent.focus();
        }

        feedbackModal.addEventListener('click', (event) => {
            if (event.target === feedbackModal) closeModal();
        });

        feedbackModal.querySelectorAll('[data-modal-close]').forEach((button) => {
            button.addEventListener('click', closeModal);
        });

        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') closeModal();
        });

        function mapErrorMessage(error) {
            const fallback = 'Please try again or contact us via WhatsApp.';
            if (!error) return fallback;
            const raw = (error.message || String(error)).trim();
            if (raw.toLowerCase().includes('open this page through a web server')) {
                return 'Please access the site via its published URL (https://...).';
            }
            return raw || fallback;
        }

        async function handleSubmit(e) {
            e.preventDefault();
            const form = e.target;
            const submitButton = form.querySelector('button[type="submit"]');
            const endpoint = 'https://formsubmit.co/ajax/murilomn58@gmail.com';

            submitButton.disabled = true;
            submitButton.textContent = texts.sending;

            const formEntries = new FormData(form);
            const faixaSelecionada = formEntries.get('faturamento');
            if (faixaSelecionada && revenueLabels[faixaSelecionada]) {
                formEntries.set('faturamento', revenueLabels[faixaSelecionada]);
            }
            formEntries.append('_subject', 'Contact from Vertech Website');
            formEntries.append('_captcha', 'false');

            try {
                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: { 'Accept': 'application/json' },
                    body: formEntries
                });

                let result = {};
                try { result = await response.json(); } catch (parseError) {
                    throw new Error('Failed to parse server response.');
                }

                if (!response.ok || result.success !== 'true') {
                    throw new Error(result.message || 'Failed to send');
                }

                form.reset();
                openModal('success', texts.successTitle, texts.successMessage);
            } catch (error) {
                console.error('Form error:', error);
                openModal('error', texts.errorTitle, mapErrorMessage(error));
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = texts.submit;
            }
        }
    </script>
</body>
</html>
